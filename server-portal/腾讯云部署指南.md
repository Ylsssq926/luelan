# è…¾è®¯äº‘æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—

## å½“å‰çŠ¶æ€
- âœ… é¡¹ç›®æ„å»ºå®Œæˆï¼š`server-portal/dist/` ç›®å½•å·²ç”Ÿæˆ
- âœ… æ„å»ºæ–‡ä»¶ï¼šindex.html, assets/ ç­‰é™æ€èµ„æº
- ğŸ”„ ç­‰å¾…éƒ¨ç½²åˆ°è…¾è®¯äº‘æœåŠ¡å™¨

## éƒ¨ç½²æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šä¸Šä¼ æ–‡ä»¶åˆ°è…¾è®¯äº‘æœåŠ¡å™¨

1. **ä½¿ç”¨SCPå‘½ä»¤ä¸Šä¼ æ–‡ä»¶**ï¼ˆåœ¨æœ¬åœ°PowerShellæ‰§è¡Œï¼‰ï¼š
```powershell
# ä¸Šä¼ æ•´ä¸ªdistç›®å½•åˆ°æœåŠ¡å™¨
scp -r .\dist\ ç”¨æˆ·å@æœåŠ¡å™¨IP:/var/www/luelan.online/main-site/

# ç¤ºä¾‹ï¼ˆæ›¿æ¢ä¸ºæ‚¨çš„å®é™…ä¿¡æ¯ï¼‰ï¼š
scp -r .\dist\ root@æ‚¨çš„æœåŠ¡å™¨IP:/var/www/luelan.online/main-site/
```

2. **æˆ–è€…ä½¿ç”¨WinSCPå›¾å½¢åŒ–å·¥å…·**ï¼š
   - ä¸‹è½½å®‰è£…WinSCP
   - è¿æ¥æœåŠ¡å™¨ï¼šSFTPåè®®ï¼Œç«¯å£22
   - å°†æœ¬åœ°distç›®å½•æ‹–æ‹½åˆ°æœåŠ¡å™¨ `/var/www/luelan.online/main-site/` ç›®å½•

### ç¬¬äºŒæ­¥ï¼šé…ç½®Nginx

1. **ç™»å½•æœåŠ¡å™¨**ï¼š
```bash
ssh root@æ‚¨çš„æœåŠ¡å™¨IP
```

2. **åˆ›å»ºNginxé…ç½®æ–‡ä»¶**ï¼š
```bash
# åˆ›å»ºç«™ç‚¹é…ç½®æ–‡ä»¶
nano /etc/nginx/conf.d/luelan.online.conf
```

3. **é…ç½®å†…å®¹**ï¼š
```nginx
server {
    listen 80;
    server_name luelan.online www.luelan.online;
    
    # ä¸»ç«™æ ¹ç›®å½•
    root /var/www/luelan.online/main-site/dist;
    index index.html;
    
    # å•é¡µåº”ç”¨è·¯ç”±æ”¯æŒ
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    # é™æ€èµ„æºç¼“å­˜
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
    
    # ç¦æ­¢è®¿é—®éšè—æ–‡ä»¶
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }
}
```

### ç¬¬ä¸‰æ­¥ï¼šè®¾ç½®æ–‡ä»¶æƒé™

```bash
# è®¾ç½®nginxç”¨æˆ·æƒé™
chown -R nginx:nginx /var/www/luelan.online/
chmod -R 755 /var/www/luelan.online/

# æ£€æŸ¥æƒé™
ls -la /var/www/luelan.online/main-site/dist/
```

### ç¬¬å››æ­¥ï¼šæµ‹è¯•å¹¶é‡å¯Nginx

```bash
# æµ‹è¯•Nginxé…ç½®
nginx -t

# é‡å¯NginxæœåŠ¡
systemctl restart nginx

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
systemctl status nginx
```

### ç¬¬äº”æ­¥ï¼šéªŒè¯éƒ¨ç½²

1. è®¿é—®ç½‘ç«™ï¼šhttp://luelan.online
2. æ£€æŸ¥æ§åˆ¶å°æ— é”™è¯¯
3. æµ‹è¯•é¡µé¢è·¯ç”±æ˜¯å¦æ­£å¸¸

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜1ï¼š403 Forbidden
```bash
# æ£€æŸ¥æ–‡ä»¶æƒé™
ls -la /var/www/luelan.online/main-site/dist/index.html

# ä¿®å¤æƒé™
chmod 644 /var/www/luelan.online/main-site/dist/*
```

### å¸¸è§é—®é¢˜2ï¼šNginxé…ç½®é”™è¯¯
```bash
# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f /var/log/nginx/error.log

# é‡æ–°åŠ è½½é…ç½®
nginx -s reload
```

### å¸¸è§é—®é¢˜3ï¼šæ–‡ä»¶ä¸å­˜åœ¨
```bash
# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la /var/www/luelan.online/main-site/dist/

# é‡æ–°ä¸Šä¼ æ–‡ä»¶
```

## è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬

åˆ›å»ºéƒ¨ç½²è„šæœ¬ `deploy.sh`ï¼š
```bash
#!/bin/bash
echo "å¼€å§‹éƒ¨ç½²ä¸»ç«™é¡¹ç›®..."

# åœæ­¢Nginx
systemctl stop nginx

# å¤‡ä»½æ—§æ–‡ä»¶
cp -r /var/www/luelan.online/main-site/dist /var/www/luelan.online/main-site/dist.backup.$(date +%Y%m%d%H%M%S)

# ä¸Šä¼ æ–°æ–‡ä»¶ï¼ˆéœ€è¦æå‰ä¸Šä¼ ï¼‰
# scpæ“ä½œ...

# è®¾ç½®æƒé™
chown -R nginx:nginx /var/www/luelan.online/
chmod -R 755 /var/www/luelan.online/

# å¯åŠ¨Nginx
systemctl start nginx

echo "éƒ¨ç½²å®Œæˆï¼"
```

## åç»­ç»´æŠ¤

1. **å®šæœŸå¤‡ä»½**ï¼šé‡è¦æ›´æ–°å‰å¤‡ä»½distç›®å½•
2. **ç›‘æ§æ—¥å¿—**ï¼šå®šæœŸæ£€æŸ¥Nginxè®¿é—®æ—¥å¿—å’Œé”™è¯¯æ—¥å¿—
3. **SSLè¯ä¹¦**ï¼šè€ƒè™‘æ·»åŠ HTTPSæ”¯æŒ

## è”ç³»æ–¹å¼
å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒæ­¤æ–‡æ¡£æˆ–è”ç³»æŠ€æœ¯æ”¯æŒã€‚